<network>
  <name>{{ item.name }}</name>
  <forward mode="{{ item.forward.mode | default("nat") }}"/>
  <bridge
    name="{{ item.bridge.name }}"
{% if item.bridge.stp is defined %}
    stp="{{ item.bridge.stp }}"
{% endif %}
{% if item.bridge.delay is defined %}
    delay="{{ item.bridge.delay }}"
{% endif %}
  />
{% if item.domain is defined and item.domain.name is defined %}
  <domain name="{{ item.domain.name }}"/>
{% endif %}
{% if item.ip is defined %}
  <ip address="{{ item.ip.address }}" netmask="{{ item.ip.netmask }}">
{% if item.ip.dhcp is defined %}
    <dhcp>
      <range start="{{ item.ip.dhcp.range.start }}" end="{{ item.ip.dhcp.range.end }}"/>
    </dhcp>
{% endif %}
  </ip>
{% endif %}
</network>
